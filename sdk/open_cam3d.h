#pragma once

#ifdef _WIN32 
#define DF_SDK_API __declspec(dllexport)

#elif __linux
#define DF_SDK_API 
#endif
 


/***************************************************************************************/

extern "C"
{

	//返回码
	//0: 成功; -1:失败; -2:未获取相机分辨率分配内存

	//相机标定参数结构体
	struct CalibrationParam
	{
		//相机内参
		float intrinsic[3 * 3];
		//相机外参
		float extrinsic[4 * 4];
		//相机畸变，只用前5个
		float distortion[1 * 12];//<k1,k2,p1,p2,k3,k4,k5,k6,s1,s2,s3,s4>

	};


	//函数名： DfConnect
	//功能： 连接相机
	//输入参数： camera_id（相机ip地址）
	//输出参数： 无
	//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
	DF_SDK_API int DfConnect(const char* camera_id);

	//函数名： DfGetCameraResolution
	//功能： 获取相机分辨率
	//输入参数： 无
	//输出参数： width(图像宽)、height(图像高)
	//返回值： 类型（int）:返回0表示获取参数成功;返回-1表示获取参数失败.
	DF_SDK_API int  DfGetCameraResolution(int* width, int* height);

	//函数名： DfCaptureData
	//功能： 采集一帧数据并阻塞至返回状态
	//输入参数： exposure_num（曝光次数）：设置值为1为单曝光，大于1为多曝光模式（具体参数在相机gui中设置）.
	//输出参数： timestamp(时间戳)
	//返回值： 类型（int）:返回0表示获取采集数据成功;返回-1表示采集数据失败.
	DF_SDK_API int DfCaptureData(int exposure_num, char* timestamp);

	//函数名： DfGetDepthData
	//功能： 采集点云数据并阻塞至返回结果
	//输入参数：无
	//输出参数： depth(深度图)
	//返回值： 类型（int）:返回0表示获取数据成功;返回-1表示采集数据失败.
	DF_SDK_API int DfGetDepthData(unsigned short* depth);


	//函数名： DfGetBrightnessData
	//功能： 采集点云数据并阻塞至返回结果
	//输入参数：无
	//输出参数： brightness(亮度图)
	//返回值： 类型（int）:返回0表示获取数据成功;返回-1表示采集数据失败.
	DF_SDK_API int DfGetBrightnessData(unsigned char* brightness);

	//函数名： DfGetHeightMapData
	//功能： 采集点云数据并阻塞至返回结果
	//输入参数：无
	//输出参数： height_map(高度映射图)
	//返回值： 类型（int）:返回0表示获取数据成功;返回-1表示采集数据失败.
	DF_SDK_API int DfGetHeightMapData(float* height_map);

	//函数名： DfGetPointcloudData
	//功能： 采集点云数据并阻塞至返回结果
	//输入参数：无
	//输出参数： point_cloud(点云)
	//返回值： 类型（int）:返回0表示获取数据成功;返回-1表示采集数据失败.
	DF_SDK_API int DfGetPointcloudData(float* point_cloud);

	//函数名： DfConnect
	//功能： 断开相机连接
	//输入参数： camera_id（相机ip地址）
	//输出参数： 无
	//返回值： 类型（int）:返回0表示断开成功;返回-1表示断开失败.
	DF_SDK_API int DfDisconnect(const char* camera_id);

	//函数名： DfGetCalibrationParam
	//功能： 获取相机标定参数
	//输入参数： 无
	//输出参数： calibration_param（相机标定参数结构体）
	//返回值： 类型（int）:返回0表示获取标定参数成功;返回-1表示获取标定参数失败.
	DF_SDK_API int DfGetCalibrationParam(struct CalibrationParam* calibration_param);


	/***************************************************************************************************************************************************************/
	 

}


/**************************************************************************************/
//函数名： DfConnectNet（区别于DfConnect:带注册的连接，DfConnectNet：不带注册直接连接）
//功能： 连接相机
//输入参数： ip
//输出参数： 无
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int DfConnectNet(const char* ip);

//函数名： DfDisconnectNet
//功能： 断开相机
//输入参数：无
//输出参数： 无
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int DfDisconnectNet();

//DF_SDK_API int DfGetCameraResolution(int* width, int* height);

//函数名： DfGetCameraData
//功能： 获取一帧相机数据
//输入参数：无
//输出参数： 无
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int DfGetCameraData(
	short* depth, int depth_buf_size,
	unsigned char* brightness, int brightness_buf_size,
	short* point_cloud, int point_cloud_buf_size,
	unsigned char* confidence, int confidence_buf_size);

//函数名： GetBrightness
//功能： 获取一个亮度图数据
//输入参数：brightness_buf_size（亮度图尺寸sizeof(unsigned char) * width * height）
//输出参数：brightness
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int GetBrightness(unsigned char* brightness, int brightness_buf_size);

//函数名： DfGetCameraRawData01
//功能： 采集一组相移图，一共24幅四步相移条纹图
//输入参数：raw_buf_size（24张8位图的尺寸）
//输出参数：raw
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int DfGetCameraRawData01(unsigned char* raw, int raw_buf_size);

//函数名： DfGetCameraRawData02
//功能： 采集一组相移图，一共37幅，24个四步相移条纹图+12个六步相移条纹图+一个亮度图
//输入参数：raw_buf_size（24张8位图的尺寸）
//输出参数：raw
//返回值： 类型（int）:返回0表示连接成功;返回-1表示连接失败.
DF_SDK_API int DfGetCameraRawData02(unsigned char* raw, int raw_buf_size);

DF_SDK_API int DfGetCameraRawDataTest(unsigned char* raw, int raw_buf_size);

DF_SDK_API int DfGetCameraRawData03(unsigned char* raw, int raw_buf_size);

DF_SDK_API bool depthTransformPointcloud(float* depth_map, float* point_cloud_map);

DF_SDK_API bool transformPointcloud(float* point_cloud_map, float* rotate, float* translation);

DF_SDK_API bool transformPointcloudInv(float* point_cloud_map, float* rotate, float* translation);

DF_SDK_API int DfGetPointCloud(float* point_cloud, int point_cloud_buf_size);

DF_SDK_API int DfGetFrame01(float* depth, int depth_buf_size,
	unsigned char* brightness, int brightness_buf_size);

DF_SDK_API int DfGetFrameHdr(float* depth, int depth_buf_size,
	unsigned char* brightness, int brightness_buf_size);

DF_SDK_API int DfGetFrame03(float* depth, int depth_buf_size,
	unsigned char* brightness, int brightness_buf_size);

DF_SDK_API int DfGetRepetitionFrame03(int count,float* depth, int depth_buf_size,
	unsigned char* brightness, int brightness_buf_size);

DF_SDK_API int DfGetCalibrationParam(struct CameraCalibParam& calibration_param);

DF_SDK_API int DfSetCalibrationParam(const struct CameraCalibParam& calibration_param);

DF_SDK_API int DfGetDeviceTemperature(float& temperature);

DF_SDK_API int DfRegisterOnDropped(int (*p_function)(void*));

DF_SDK_API int DfGetSystemConfigParam(struct SystemConfigParam& config_param);

DF_SDK_API int DfSetSystemConfigParam(const struct SystemConfigParam& config_param);

DF_SDK_API int DfEnableCheckerboard(float& temperature);

DF_SDK_API int DfDisableCheckerboard(float& temperature);

DF_SDK_API int DfLoadPatternData(int buildDataSize, char* LoadBuffer);

DF_SDK_API int DfProgramPatternData(char* org_buffer, char* back_buffer, unsigned int pattern_size);

DF_SDK_API int DfGetNetworkBandwidth(int &speed);